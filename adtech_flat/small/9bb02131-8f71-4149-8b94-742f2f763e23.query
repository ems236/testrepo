{
  "query": "select  \n  BIGINT(coalesce(case when  (ref_3.session_begin_time <= timestamp('2018-01-01 07:45:05.865456000'))  then subq_0.c1 else subq_0.c1 end\n      ,\n    ref_1.session_id)) as c0, \n  ref_3.session_event_ms_offset as c1, \n  rand() as c2\nfrom \n  system.adtech_flat as ref_0\n    inner join system.adtech_flat as ref_1\n        right join system.adtech_flat as ref_2\n          right join system.adtech_flat as ref_3\n          on ( (ref_2.device_id <= hash('0x71985c7855ea028eda4a05b6ca3058df9fcc95a7', 20)) )\n        on (ref_1.device_id is not NULL)\n      left join (select  \n            covariance(\n              BIGINT(ref_4.session_id),\n              DECIMAL(DECIMAL(6))) as c0, \n            ref_4.session_id as c1\n          from \n            system.adtech_flat as ref_4\n          where (((ref_4.session_device_longitude = DECIMAL(4)) \n                or (( (ref_4.session_begin_time >= timestamp('2018-01-01 05:42:22.386382000')) ) \n                  and (ref_4.ip_state SIMILAR TO ref_4.session_app_developer))) \n              and ((select skew(device_user_age) from system.adtech_flat)\n                   = ref_4.session_device_accuracy)) \n            and ( (NOT ref_4.session_app_name >= char('Audiobooks from Audible')) )\n          group by 2\n          order by 1 DESC NULLS FIRST, 2 ASC NULLS LAST\n          offset 39 ) as subq_0\n      on (ref_1.ip_zip < subq_0.c0)\n    on ((ref_2.session_event_ms_offset is not NULL) \n        and (ref_3.session_app_category is NULL))\nwhere  (ref_3.session_app_name > char('Stack the States'))  and  (NOT ref_3.device_id <= hash('0x6b2f1ccc4e2b4c3cec5f09d4b7fddcaa69ff7a1a', 20) and ref_3.session_app_name < char('YouTube: Watch, Listen, Stream')) \ngroup by 1,2,3\nlimit 88 \n",
  "id": "9bb02131-8f71-4149-8b94-742f2f763e23",
  "gqr_flags": {},
  "jira_ticket": "DB-19131"
}